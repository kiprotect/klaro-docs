'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var _window$preact=window.preact,Component=_window$preact.Component,h=_window$preact.h,render=_window$preact.render,App=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:'componentDidMount',value:function a(){this.setState({message:'Hello!'})}},{key:'render',value:function(){return h('div',{id:'app'},h(Form))}}]),b}(Component),translations={"Invalid email address.":'Bitte geben Sie eine g\xFCltige E-Mail Adresse an.'},Form=function(a){function b(){var a,c,d,e;_classCallCheck(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return e=(c=(d=_possibleConstructorReturn(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d),d.state={submitting:!1,status:'pending',data:{},errors:{}},c),_possibleConstructorReturn(d,e)}return _inherits(b,a),_createClass(b,[{key:'encodeData',value:function d(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+'='+encodeURIComponent(a[c]));return b.join('&')}},{key:'submitData',value:function d(a){var b=new XMLHttpRequest,c=this.encodeData(a);$.ajax({type:'POST',url:'https://auth.kiprotect.com/api/newsletter/v1/subscribe/newsletter',crossDomain:!0,data:c}).done(function(){this.setState({status:'success'})}.bind(this)).fail(function(a){var b=a.responseJSON;if(void 0!==b&&void 0!==b.errors){var c={},d=b.errors;for(var e in d)c[e]=d[e]in translations?translations[d[e]]:d[e];this.setState({status:'pending',errors:c})}else this.setState({status:'failed'})}.bind(this))}},{key:'onSubmit',value:function d(a){var b=this.state;a.preventDefault();var c=this.validate(b.data);return 0<Object.keys(c).length?void this.setState({errors:c}):void(this.setState({status:'sending',errors:{}}),this.submitData(b.data))}},{key:'validate',value:function e(a){var b={},c=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i;if(a.email||(b.email='Bitte geben Sie eine E-Mail Adresse an.'),c.test(a.email)||(b.email='Bitte geben Sie eine g\xFCltige E-Mail Adresse an.'),a.name){var d=/^.{3,50}$/i;d.test(a.name)||(b.name='Bitte geben Sie einen g\xFCltigen Namen an (mindestens drei Zeichen, maximal 50).')}return b}},{key:'setValue',value:function d(a,b){var c=this.state.data;c[a]=b.target.value,this.setState({data:c})}},{key:'renderSuccess',value:function a(){return h('div',null,h('h2',null,'Vielen Dank!'),h('p',{class:'alert alert-success'},'Ihre Angaben wurden erfolgreich gespeichert.'))}},{key:'render',value:function(){return'success'==this.state.status?this.renderSuccess():this.renderForm()}},{key:'renderForm',value:function i(){function a(a){return f[a]?h('p',{class:'alert alert-warning'},f[a]):null}var b,d=this,c=this.state,e=c.data,f=c.errors,g=this.state.status;return'failed'==g&&(b=h('p',{class:'alert alert-warning'},'Beim Versenden Ihrer Daten ist leider etwas schiefgegangen. Sie k\xF6nnen uns alternativ auch eine E-Mail an ',h('a',{href:'mailto:newsletter@kiprotect.com'},'newsletter@kiprotect.com'),' schicken. Wir bitten die Unannehmlichkeiten zu entschuldigen.')),h('form',{ref:function b(a){return d.form=a},id:'signup',onSubmit:this.onSubmit.bind(this)},b,h('fieldset',{disabled:'sending'===g},h('div',{class:'form-group row'},h('label',{for:'email',class:'col-md-4 col-lg-3 col-form-label'},'Email'),h('div',{class:'col-md-8 col-lg-9'},a('email'),h('input',{type:'email',class:'form-control',id:'email',placeholder:'david.duesentrieb@muster-ag.de',onChange:this.setValue.bind(this,'email'),value:e.email||''}))),h('div',{class:'form-group row'},h('label',{for:'name',class:'col-md-4 col-lg-3 col-form-label'},'Name (optional)'),h('div',{class:'col-md-8 col-lg-9'},a('name'),h('input',{type:'text',class:'form-control',id:'name',placeholder:'David D\xFCsentrieb',onChange:this.setValue.bind(this,'name'),value:e.name||''}))),h('div',{class:'form-group row'},h('label',{class:'d-xs-none col-md-4 col-lg-3 col-form-label'}),h('div',{class:'col-md-8 col-lg-9'},h('button',{type:'submit',class:'btn btn-green btn-intro btn-lg'},'sending'==g?'Bitte warten...':'Anmelden')))))}}]),b}(Component);$(document).ready(function(){var a=document.getElementById('signup-wrapper');a.innerHTML='',render(h(App),a)});